[platformio]
default_envs = esp32dev

# ===== Global Settings =====
[env]
framework = arduino
monitor_speed = 921600
monitor_filters =
    colorize
    time
build_flags =
    -I include

# ===== ESP32 DEV BOARD (ESP32-WROOM-32) =====
[env:esp32dev]
platform = espressif32
board = esp32dev
board_build.mcu = esp32
board_build.f_cpu = 240000000L
upload_speed = 921600

# HX711 Load Cell Configuration for ESP32 Dev Board
# THRUST TEST MODE - 80Hz high-speed sampling
#
# IMPORTANT: For 80Hz operation, modify your HX711 board:
#   - Locate RATE pin jumper
#   - Either: cut trace to GND, or bridge RATE to VCC
#   - This enables 80Hz instead of default 10Hz
#
# Wiring:
#   HX711 VCC  -> ESP32 3.3V
#   HX711 GND  -> ESP32 GND
#   HX711 DT   -> ESP32 GPIO16 (Data)
#   HX711 SCK  -> ESP32 GPIO4  (Clock)
#
# Load Cell to HX711:
#   Red   (E+) -> HX711 E+
#   Black (E-) -> HX711 E-
#   White (A-) -> HX711 A-
#   Green (A+) -> HX711 A+

build_flags =
    ${env.build_flags}
    -D BOARD_ESP32_DEV
    -D LOADCELL_DOUT_PIN=16
    -D LOADCELL_SCK_PIN=4
    -D BOARD_NAME=\"ESP32Dev\"
    -D HX711_80HZ_MODE=1
    ; Calibration factor in Newtons (run calibration to find your value)
    ; Formula: cal_factor = raw_difference / known_force_N
    -D CALIBRATION_FACTOR=1500.0
    ; Enable Web Dashboard (comment out to disable)
    -D ENABLE_WEB_DASHBOARD
    ; Teensy UART Configuration (comment out to disable)
    -D ENABLE_TEENSY_UART
    -D TEENSY_UART_TX_PIN=17
    -D TEENSY_UART_RX_PIN=5

lib_deps =
    bogde/HX711@^0.7.5
    mathieucarbou/ESPAsyncWebServer@^3.4.5
    bblanchon/ArduinoJson@^7.0.0

board_build.filesystem = littlefs
