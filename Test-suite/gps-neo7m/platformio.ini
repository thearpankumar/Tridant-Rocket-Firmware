[platformio]
default_envs = esp32dev, uno

# ===== Global Settings =====
[env]
framework = arduino
monitor_speed = 115200
monitor_filters =
    colorize
    time
build_flags =
    -I include

# ===== ESP32 DEV BOARD (ESP32-WROOM-32) =====
[env:esp32dev]
platform = espressif32
board = esp32dev
board_build.mcu = esp32
board_build.f_cpu = 240000000L
upload_speed = 921600

# GPS NEO-7M Configuration for ESP32 Dev Board
# Using UART2 (Hardware Serial 2) for GPS communication
# Wiring:
#   GPS VCC  -> ESP32 5V (VIN)
#   GPS GND  -> ESP32 GND
#   GPS TX   -> ESP32 GPIO16 (RX2)
#   GPS RX   -> ESP32 GPIO17 (TX2)
#   GPS PPS  -> ESP32 GPIO4 (optional)
build_flags =
    ${env.build_flags}
    -D BOARD_ESP32_DEV
    -D USE_HARDWARE_SERIAL
    -D GPS_RX_PIN=16
    -D GPS_TX_PIN=17
    -D GPS_PPS_PIN=4
    -D GPS_BAUD=9600
    -D BOARD_NAME=\"ESP32Dev\"

lib_deps =
    mikalhart/TinyGPSPlus@^1.0.3

# ===== ARDUINO UNO (ATmega328P) =====
[env:uno]
platform = atmelavr
board = uno
board_build.mcu = atmega328p
board_build.f_cpu = 16000000L
upload_speed = 115200

# GPS NEO-7M Configuration for Arduino Uno
# Using SoftwareSerial (Uno has only 1 HW UART used for USB)
# Wiring:
#   GPS VCC  -> Arduino 5V
#   GPS GND  -> Arduino GND
#   GPS TX   -> Arduino Pin 4 (SoftwareSerial RX)
#   GPS RX   -> Arduino Pin 3 (SoftwareSerial TX) via voltage divider!
#   GPS PPS  -> Arduino Pin 2 (optional)
#
# IMPORTANT: Arduino Uno is 5V logic, GPS is 3.3V!
#   - GPS TX (3.3V) -> Uno Pin 4: OK (Uno reads 3.3V as HIGH)
#   - Uno Pin 3 (5V) -> GPS RX: USE VOLTAGE DIVIDER!
#     Use 1K + 2K resistor divider to convert 5V to 3.3V
build_flags =
    ${env.build_flags}
    -D BOARD_ARDUINO_UNO
    -D USE_SOFTWARE_SERIAL
    -D GPS_RX_PIN=4
    -D GPS_TX_PIN=3
    -D GPS_PPS_PIN=2
    -D GPS_BAUD=9600
    -D BOARD_NAME=\"ArduinoUno\"

lib_deps =
    mikalhart/TinyGPSPlus@^1.0.3
